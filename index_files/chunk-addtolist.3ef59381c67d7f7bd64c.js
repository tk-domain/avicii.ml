webpackJsonp([78],{859:function(t,e,i){var l,a,o,s,d,n,c,r,m,u;l=i(2),o=i(3),a=i(11),u=i(5),n=i(306),c=i(25),m=i(13),i(361),s=ds.require("alerts"),d=u.getUrl,r={},r.init=function(){return this.$modal=!1,l("body").on("click",".add_to_list",r.listAddHandler).on("click",".remove_from_list",r.remove)},r.listAddHandler=function(t){var e;t.preventDefault(),e=l(this),u.requireLogin()&&u.requireActivation()&&r.add(e.data("list-add-url"),e.data("list-add-pos"))},r.toggleForm=function(){l(".listadd_new").toggle(l("#listpick_new").checked),l("#listadd_old").toggle(l("#listpick_old").checked)},r.add=function(t,e){var i,o;return o=function(){e&&n.legacyTrack("list","opened modal",e)},!!t&&(r.modal||(r.modal=r.makeModal()),r.modal.then(function(t){t.dialog("close")}),i=l.get(d(t),{styleVersion:!0}),a.all([r.modal,i]).then(function(t){var e,i;e=t[0],i=t[1],r.insertAndShowModal(e,i),o()}),!0)},r.makeModal=function(){var t;return t=l("<div />").hide().appendTo("body").on("change","#listpick_old, #listpick_new",r.toggleForm).on("click",".lists_list_add_save",r.addSave).on("click",".lists_list_add_cancel",r.addCancel).on("click",".close_add_to_list",r.close),r.$modal=t,r.dialogConfig={width:l("html").hasClass("is_mobile")?l(window).width():440,title:c.getText("Add to List")()},t.discogsDialog(r.dialogConfig).then(function(){return t})},r.insertAndShowModal=function(t,e){var i;i=l("#act"),i.hide(),t.html(e).show().dialog("open")},r.addSave=function(){var t,e,i,a,m,u,_;if(i=l("#list_comments").val(),_=l("#list_title").val(),a=l("#list_description").val(),m=l("#list_oldpick"),t={what:l("#list_what").val(),obid:l("#list_obid").val()},e=function(e){var i,a,d,n;e.success&&e.list_view_href&&e.my_lists_href&&e.close_button?(n=o.template(l("#list_success_message").html())(e),d=o.template(l("#list_new_list_tpl").html())(o.extend(t,e)),a=l("#lists"),i=a.find(".add_to_list"),r.$modal.html(n).show().dialog("open"),a.prepend(d),i.length&&i.appendTo(a.prev("h3"))):e.message&&s.alert(e.message)},i&&(i=l.trim(o.stripTags(i)),t.comments=i),l("#listpick_new").is(":checked")){if(!_)return void s.alert(c.getText("Please enter a title.")());a&&(a=l.trim(o.stripTags(a)),t.description=a),t.list="new",t.title=_}else{if(u=m.val(),u===-1)return void s.alert(c.getText("Please select an existing list.")());t.title=m.find("option:selected").html(),t.list=u}r.$modal.dialog("close"),l.ajax({type:"POST",url:d("/lists/addsave"),data:t,success:e}).then(function(){n.legacyTrack("list","added",t.what)})},r.addCancel=function(){r.$modal.dialog("close")},r.remove=function(){var t,e,i;return e=function(){return l.ajax({type:"POST",url:d("/lists/update_item"),data:"list="+t.data("list-remove-id")+"&what="+i+"&obid="+t.data("list-remove-obid")+"&remove=1",success:t.remove()})},t=l(this).parent(),i=t.data("list-remove-what"),u.confirm(c.getText("Are you sure you want to remove this item?")()).then(e).then(function(){n.legacyTrack("list","removed",i)})},r.close=function(){var t,e;t=l(this),e=t.data("on-click"),"reload_page"===e?window.location.reload():"hide_list_panel"===e&&r.$modal.dialog("close")},m(function(){return r.init()}),t.exports=r}});
//# sourceMappingURL=chunk-addtolist.3ef59381c67d7f7bd64c.js.map